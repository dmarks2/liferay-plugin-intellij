buildscript {
    repositories {
        maven { url "https://cache-redirector.jetbrains.com/intellij-dependencies" }
        maven { url "https://cache-redirector.jetbrains.com/repo1.maven.org/maven2" }
        maven { url "https://plugins.gradle.org/m2" }
    }
}

plugins {
    id "org.jetbrains.intellij" version "1.13.3"
    id 'de.undercouch.download' version '5.2.1'
}

configurations {
    poshi
}

repositories {
    maven { url "https://repository-cdn.liferay.com/nexus/content/groups/public/" }
}

import de.undercouch.gradle.tasks.download.Download

apply plugin: 'idea'
apply plugin: 'org.jetbrains.intellij'
apply plugin: 'java'

sourceCompatibility = 1.17

tasks.withType(JavaCompile).configureEach {
    options.compilerArgs << "-Xlint:unchecked"
    options.deprecation = true
    options.encoding = 'UTF-8'
}

def generatedResources = "$buildDir/generated-resources"
def tempDir = "$buildDir/tmp"
def mockDir = "$buildDir/mock"

test {
    testLogging {
        exceptionFormat = 'full'
    }
    systemProperty "idea.home.path", mockDir
    scanForTestClasses false
    include "**/*Test.class"
}

sourceSets {
    main {
        java {
            srcDirs = ['src/main/java', 'src/main/gen']
        }
        resources {
            srcDirs = ['src/main/resources']
        }

        output.dir(generatedResources, builtBy: ['generateLiferayTemplateHelperFiles', 'generateLiferayDefinitions', 'generateLiferayPortalPropertiesFiles', 'unzipCompass0122Stylesheets', 'unzipCompass0122SassExtensions', 'generateTaglibDefinitions', 'downloadIntelliJCommunityMockJDK11', "downloadSchemaDefinitions", "downloadPoshiGrammar", "downloadPoshi"])
    }
    poshi {
        java {
            srcDirs = ['src/main/poshi']
        }
    }
}

repositories {
    mavenCentral()
}

//https://github.com/JetBrains/intellij-community/tree/master/.idea/libraries

dependencies {
    testImplementation group: 'junit', name: 'junit', version: '4.11'
    //compileOnly 'org.jetbrains.plugins:maven-server-api:2016.3'
    compileOnly 'com.github.adedayo.intellij.sdk:maven-server-api:142.1'

//    compileOnly 'org.apache.httpcomponents:httpclient:4.5.13'
//    compileOnly 'com.google.code.gson:gson:2.10'

//    implementation 'org.glassfish:javax.json:1.1'
//    compile files(org.gradle.internal.jvm.Jvm.current().toolsJar)
    implementation 'org.freemarker:freemarker:2.3.28'

//    implementation 'org.glassfish.jersey.core:jersey-client:2.26'
//    implementation 'org.glassfish.jersey.media:jersey-media-multipart:2.26'
//    implementation 'org.glassfish.jersey.media:jersey-media-json-jackson:2.26'
//    implementation 'org.glassfish.jersey.inject:jersey-hk2:2.26'
//    implementation 'com.fasterxml.jackson.datatype:jackson-datatype-json-org:2.9.0'
//    implementation 'org.json:json:20171018'

    implementation 'com.liferay:com.liferay.poshi.runner.resources:1.0.14'

    poshiImplementation 'com.liferay:com.liferay.poshi.runner.resources:1.0.14'
    poshiImplementation('com.liferay:com.liferay.poshi.runner:1.0.396') {
        exclude group: 'org.arquillian.rusheye', module: 'rusheye-api'
        exclude group: 'org.arquillian.rusheye', module: 'rusheye-impl'
    }
    poshiImplementation 'io.github.bonigarcia:webdrivermanager:5.3.1'
}

intellij {
//    version "IU-2017.3.4"
//    version "IU-2018.1.1"
//    version "IU-2018.3.4"
//    version "IU-2019.3.4"
//    version "IU-2020.2.1"
//    version "IU-2020.3"
//    version.set("IU-2021.1")
//    version.set("IU-2021.2")
//    version.set("IU-2021.3")
//    version.set("IU-2022.1.2")
//    version.set("IU-2022.3")
    version.set("IU-2023.1")
    type.set('IU')
    pluginName.set('Liferay IntelliJ Plugin')
    plugins.set([
            'JavaScript', 'Tomcat', 'com.intellij.velocity', 'com.intellij.freemarker', 'maven', 'properties', 'java-i18n', 'com.intellij.css', 'sass', 'JavaEE', 'com.intellij.javaee.web', 'com.intellij.jsp', 'gradle',
            'org.intellij.intelliLang', 'uml', 'java', 'XPathView',
            //test only?
            'Groovy', 'junit', 'com.intellij.persistence', 'DatabaseTools', 'yaml'
    ])
    updateSinceUntilBuild.set(false)
}

runIde {
    jvmArgs '-Xmx2048m'
}

tasks.register('generateLiferayPortalPropertiesFiles') {
    doLast {
        def target70 = new File(generatedResources, "com/liferay/properties/70");
        def target71 = new File(generatedResources, "com/liferay/properties/71");
        def target72 = new File(generatedResources, "com/liferay/properties/72");
        def target73 = new File(generatedResources, "com/liferay/properties/73");
        def target74 = new File(generatedResources, "com/liferay/properties/74");
        target70.mkdirs();
        target71.mkdirs();
        target72.mkdirs();
        target73.mkdirs();
        target74.mkdirs();

        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/portal-impl/src/portal.properties'
            dest new File(target70, "portal.properties")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/portal-impl/src/portal.properties'
            dest new File(target71, "portal.properties")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/portal-impl/src/portal.properties'
            dest new File(target72, "portal.properties")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/portal-impl/src/portal.properties'
            dest new File(target73, "portal.properties")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/master/portal-impl/src/portal.properties'
            dest new File(target74, "portal.properties")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
    }
}

tasks.register('generateLiferayTemplateHelperFiles') {
    doLast {
        def targetVtl = new File(generatedResources, "com/liferay/vtl");
        def targetFtl = new File(generatedResources, "com/liferay/ftl");
        targetVtl.mkdirs();
        targetFtl.mkdirs();

        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/6.1.x/portal-impl/src/VM_liferay.vm'
            dest new File(targetVtl, "VM_liferay_61.vm")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/6.2.x/portal-impl/src/VM_liferay.vm'
            dest new File(targetVtl, "VM_liferay_62.vm")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/foundation/portal-template/portal-template-velocity/src/main/resources/VM_liferay.vm'
            dest new File(targetVtl, "VM_liferay_70.vm")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/6.1.x/portal-impl/src/FTL_liferay.ftl'
            dest new File(targetFtl, "FTL_liferay_61.ftl")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/6.2.x/portal-impl/src/FTL_liferay.ftl'
            dest new File(targetFtl, "FTL_liferay_62.ftl")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/foundation/portal-template/portal-template-freemarker/src/main/resources/FTL_liferay.ftl'
            dest new File(targetFtl, "FTL_liferay_70.ftl")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/portal-template/portal-template-freemarker/src/main/resources/FTL_liferay.ftl'
            dest new File(targetFtl, "FTL_liferay_71.ftl")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/portal-template/portal-template-freemarker/src/main/resources/FTL_liferay.ftl'
            dest new File(targetFtl, "FTL_liferay_72.ftl")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/portal-template/portal-template-freemarker/src/main/resources/FTL_liferay.ftl'
            dest new File(targetFtl, "FTL_liferay_73.ftl")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/portal-template/portal-template-freemarker/src/main/resources/FTL_liferay.ftl'
            dest new File(targetFtl, "FTL_liferay_74.ftl")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
    }
}
tasks.register('generateLiferayDefinitions') {
    doLast {
        def target = new File(generatedResources, "com/liferay/definitions");
        target.mkdirs();

        download.run {
            src([
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-ddm-structure_6_2_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-ddm-structure_6_2_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-display_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-display_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-display_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-display_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-display_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-display_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-display_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-friendly-url-routes_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-friendly-url-routes_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-friendly-url-routes_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-friendly-url-routes_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-friendly-url-routes_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-friendly-url-routes_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-friendly-url-routes_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-hook_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-hook_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-hook_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-hook_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-hook_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-hook_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-hook_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-layout-templates_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-layout-templates_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-layout-templates_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-layout-templates_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-layout-templates_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-layout-templates_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-layout-templates_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-look-and-feel_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-look-and-feel_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-look-and-feel_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-look-and-feel_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-look-and-feel_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-look-and-feel_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-look-and-feel_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-package_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-package_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-package_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-package_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-package_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-package_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-package_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-repository_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-repository_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-repository_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-repository_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-repository_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-repository_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-plugin-repository_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-portlet-app_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-portlet-app_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-portlet-app_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-portlet-app_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-portlet-app_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-portlet-app_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-portlet-app_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-resource-action-mapping_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-resource-action-mapping_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-resource-action-mapping_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-resource-action-mapping_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-resource-action-mapping_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-resource-action-mapping_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-resource-action-mapping_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-service-builder_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-service-builder_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-service-builder_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-service-builder_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-service-builder_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-service-builder_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-service-builder_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-social_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-social_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-social_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-social_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-social_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-social_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-social_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-theme-loader_6_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-theme-loader_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-theme-loader_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-theme-loader_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-theme-loader_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-theme-loader_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-theme-loader_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-user-notification-definitions_6_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-user-notification-definitions_7_0_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-user-notification-definitions_7_1_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-user-notification-definitions_7_2_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-user-notification-definitions_7_3_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-user-notification-definitions_7_4_0.dtd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-workflow-definition_6_1_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-workflow-definition_6_2_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-workflow-definition_7_0_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-workflow-definition_7_1_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-workflow-definition_7_2_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-workflow-definition_7_3_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/liferay-workflow-definition_7_4_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/portlet-app_2_0.xsd',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/definitions/portlet-app_3_0.xsd'
            ])
            dest target
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
    }
}

tasks.register('generateTaglibDefinitions') {
    doLast {
        def target70 = new File(generatedResources, "com/liferay/tld/70");
        def target71 = new File(generatedResources, "com/liferay/tld/71");
        def target72 = new File(generatedResources, "com/liferay/tld/72");
        def target73 = new File(generatedResources, "com/liferay/tld/73");
        def target74 = new File(generatedResources, "com/liferay/tld/74");
        target70.mkdirs();
        target71.mkdirs();
        target72.mkdirs();
        target73.mkdirs();
        target74.mkdirs();

        download.run {
            src([
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/util-taglib/src/META-INF/liferay-aui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/util-taglib/src/META-INF/liferay-portlet-ext.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/util-taglib/src/META-INF/liferay-portlet.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/util-taglib/src/META-INF/liferay-security.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/util-taglib/src/META-INF/liferay-theme.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/util-taglib/src/META-INF/liferay-ui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/util-taglib/src/META-INF/liferay-util.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/adaptive-media/adaptive-media-image-taglib/src/main/resources/META-INF/liferay-adaptive-media.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/web-experience/asset/asset-taglib/src/main/resources/META-INF/liferay-asset.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/foundation/expando/expando-taglib/src/main/resources/META-INF/liferay-expando.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/collaboration/flags/flags-taglib/src/main/resources/META-INF/liferay-flags.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/foundation/frontend-taglib/frontend-taglib/src/main/resources/META-INF/liferay-frontend.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/collaboration/item-selector/item-selector-taglib/src/main/resources/META-INF/liferay-item-selector.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/web-experience/journal/journal-taglib/src/main/resources/META-INF/liferay-journal.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/web-experience/layout/layout-taglib/src/main/resources/META-INF/liferay-layout.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/foundation/map/map-taglib/src/main/resources/META-INF/liferay-map.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/web-experience/product-navigation/product-navigation-taglib/src/main/resources/META-INF/liferay-product-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/web-experience/site-navigation/site-navigation-taglib/src/main/resources/META-INF/liferay-site-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.0.x/modules/apps/web-experience/trash/trash-taglib/src/main/resources/META-INF/liferay-trash.tld'
            ])
            dest target70
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }

        download.run {
            src([
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/util-taglib/src/META-INF/liferay-aui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/util-taglib/src/META-INF/liferay-portlet-ext.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/util-taglib/src/META-INF/liferay-portlet.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/util-taglib/src/META-INF/liferay-security.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/util-taglib/src/META-INF/liferay-theme.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/util-taglib/src/META-INF/liferay-ui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/util-taglib/src/META-INF/liferay-util.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/adaptive-media/adaptive-media-image-taglib/src/main/resources/META-INF/liferay-adaptive-media.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/asset/asset-taglib/src/main/resources/META-INF/liferay-asset.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/frontend-taglib/frontend-taglib-chart/src/main/resources/META-INF/liferay-chart.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/frontend-taglib/frontend-taglib-clay/src/main/resources/META-INF/liferay-clay.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/comment/comment-taglib/src/main/resources/META-INF/liferay-comment.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/frontend-editor/frontend-editor-taglib/src/main/resources/META-INF/liferay-editor.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/expando/expando-taglib/src/main/resources/META-INF/liferay-expando.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/flags/flags-taglib/src/main/resources/META-INF/liferay-flags.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/fragment/fragment-taglib/src/main/resources/META-INF/liferay-fragment.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/frontend-taglib/frontend-taglib/src/main/resources/META-INF/liferay-frontend.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/item-selector/item-selector-taglib/src/main/resources/META-INF/liferay-item-selector.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/journal/journal-taglib/src/main/resources/META-INF/liferay-journal.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/layout/layout-taglib/src/main/resources/META-INF/liferay-layout.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/map/map-taglib/src/main/resources/META-INF/liferay-map.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/product-navigation/product-navigation-taglib/src/main/resources/META-INF/liferay-product-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/reading-time/reading-time-taglib/src/main/resources/META-INF/liferay-reading-time.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/rss/rss-taglib/src/main/resources/META-INF/liferay-rss.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/site/site-taglib/src/main/resources/META-INF/liferay-site.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/site-navigation/site-navigation-taglib/src/main/resources/META-INF/liferay-site-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/social/social-activities-taglib/src/main/resources/META-INF/liferay-social-activities.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/social/social-bookmarks-taglib/src/main/resources/META-INF/liferay-social-bookmarks.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.1.x/modules/apps/trash/trash-taglib/src/main/resources/META-INF/liferay-trash.tld'
            ])
            dest target71
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }

        download.run {
            src([
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/util-taglib/src/META-INF/liferay-aui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/util-taglib/src/META-INF/liferay-portlet-ext.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/util-taglib/src/META-INF/liferay-portlet.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/util-taglib/src/META-INF/liferay-security.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/util-taglib/src/META-INF/liferay-theme.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/util-taglib/src/META-INF/liferay-ui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/util-taglib/src/META-INF/liferay-util.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/adaptive-media/adaptive-media-image-taglib/src/main/resources/META-INF/liferay-adaptive-media.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/asset/asset-taglib/src/main/resources/META-INF/liferay-asset.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/frontend-taglib/frontend-taglib-chart/src/main/resources/META-INF/liferay-chart.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/frontend-taglib/frontend-taglib-clay/src/main/resources/META-INF/liferay-clay.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/comment/comment-taglib/src/main/resources/META-INF/liferay-comment.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/document-library/document-library-taglib/src/main/resources/META-INF/liferay-document-library.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/frontend-editor/frontend-editor-taglib/src/main/resources/META-INF/liferay-editor.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/expando/expando-taglib/src/main/resources/META-INF/liferay-expando.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/flags/flags-taglib/src/main/resources/META-INF/liferay-flags.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/fragment/fragment-taglib/src/main/resources/META-INF/liferay-fragment.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/frontend-taglib/frontend-taglib/src/main/resources/META-INF/liferay-frontend.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/item-selector/item-selector-taglib/src/main/resources/META-INF/liferay-item-selector.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/journal/journal-taglib/src/main/resources/META-INF/liferay-journal.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/layout/layout-taglib/src/main/resources/META-INF/liferay-layout.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/map/map-taglib/src/main/resources/META-INF/liferay-map.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/product-navigation/product-navigation-taglib/src/main/resources/META-INF/liferay-product-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/reading-time/reading-time-taglib/src/main/resources/META-INF/liferay-reading-time.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/rss/rss-taglib/src/main/resources/META-INF/liferay-rss.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/sharing/sharing-taglib/src/main/resources/META-INF/liferay-sharing.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/site/site-taglib/src/main/resources/META-INF/liferay-site.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/site-navigation/site-navigation-taglib/src/main/resources/META-INF/liferay-site-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/social/social-activities-taglib/src/main/resources/META-INF/liferay-social-activities.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/social/social-bookmarks-taglib/src/main/resources/META-INF/liferay-social-bookmarks.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.2.x/modules/apps/trash/trash-taglib/src/main/resources/META-INF/liferay-trash.tld'
            ])
            dest target72
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }

        download.run {
            src([
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/util-taglib/src/META-INF/liferay-aui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/util-taglib/src/META-INF/liferay-portlet-ext.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/util-taglib/src/META-INF/liferay-portlet.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/util-taglib/src/META-INF/liferay-security.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/util-taglib/src/META-INF/liferay-theme.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/util-taglib/src/META-INF/liferay-ui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/util-taglib/src/META-INF/liferay-util.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/adaptive-media/adaptive-media-image-taglib/src/main/resources/META-INF/liferay-adaptive-media.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/asset/asset-taglib/src/main/resources/META-INF/liferay-asset.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/frontend-taglib/frontend-taglib-chart/src/main/resources/META-INF/liferay-chart.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/frontend-taglib/frontend-taglib-clay/src/main/resources/META-INF/liferay-clay.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/comment/comment-taglib/src/main/resources/META-INF/liferay-comment.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/document-library/document-library-taglib/src/main/resources/META-INF/liferay-document-library.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/frontend-editor/frontend-editor-taglib/src/main/resources/META-INF/liferay-editor.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/expando/expando-taglib/src/main/resources/META-INF/liferay-expando.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/flags/flags-taglib/src/main/resources/META-INF/liferay-flags.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/fragment/fragment-taglib/src/main/resources/META-INF/liferay-fragment.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/frontend-taglib/frontend-taglib/src/main/resources/META-INF/liferay-frontend.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/item-selector/item-selector-taglib/src/main/resources/META-INF/liferay-item-selector.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/journal/journal-taglib/src/main/resources/META-INF/liferay-journal.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/layout/layout-taglib/src/main/resources/META-INF/liferay-layout.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/map/map-taglib/src/main/resources/META-INF/liferay-map.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/product-navigation/product-navigation-taglib/src/main/resources/META-INF/liferay-product-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/reading-time/reading-time-taglib/src/main/resources/META-INF/liferay-reading-time.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/rss/rss-taglib/src/main/resources/META-INF/liferay-rss.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/sharing/sharing-taglib/src/main/resources/META-INF/liferay-sharing.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/site/site-taglib/src/main/resources/META-INF/liferay-site.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/site-navigation/site-navigation-taglib/src/main/resources/META-INF/liferay-site-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/social/social-activities-taglib/src/main/resources/META-INF/liferay-social-activities.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/social/social-bookmarks-taglib/src/main/resources/META-INF/liferay-social-bookmarks.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/trash/trash-taglib/src/main/resources/META-INF/liferay-trash.tld'
            ])
            dest target73
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }

        download.run {
            src([
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/util-taglib/src/META-INF/liferay-aui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/util-taglib/src/META-INF/liferay-portlet-ext.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/util-taglib/src/META-INF/liferay-portlet.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/util-taglib/src/META-INF/liferay-security.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/util-taglib/src/META-INF/liferay-theme.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/util-taglib/src/META-INF/liferay-ui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/util-taglib/src/META-INF/liferay-util.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/adaptive-media/adaptive-media-image-taglib/src/main/resources/META-INF/liferay-adaptive-media.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/alloy/alloy-mvc/src/main/resources/META-INF/alloy-util.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/7.3.x/modules/apps/alloy/alloy-mvc/src/main/resources/META-INF/alloy-permission.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/application-list/application-list-taglib/src/main/resources/META-INF/resources/liferay-application-list.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/asset/asset-taglib/src/main/resources/META-INF/liferay-asset.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/captcha/captcha-taglib/src/main/resources/META-INF/liferay-captcha.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/comment/comment-taglib/src/main/resources/META-INF/liferay-comment.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/commerce/commerce-cart-taglib/src/main/resources/META-INF/liferay-commerce-cart.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/commerce/commerce-frontend-taglib/src/main/resources/META-INF/liferay-commerce-ui.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/commerce/commerce-product-taglib/src/main/resources/META-INF/liferay-commerce-product.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/commerce/commerce-taglib/src/main/resources/META-INF/liferay-commerce.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/data-engine/data-engine-taglib/src/main/resources/META-INF/resources/liferay-data-engine.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/document-library/document-library-taglib/src/main/resources/META-INF/liferay-document-library.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/dynamic-data-mapping/dynamic-data-mapping-taglib/src/main/resources/META-INF/resources/liferay-ddm.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/dynamic-data-mapping/dynamic-data-mapping-form-taglib/src/main/resources/META-INF/resources/liferay-form.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/expando/expando-taglib/src/main/resources/META-INF/liferay-expando.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/export-import/export-import-changeset-taglib/src/main/resources/META-INF/resources/liferay-export-import-changeset.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/flags/flags-taglib/src/main/resources/META-INF/liferay-flags.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/friendly-url/friendly-url-taglib/src/main/resources/META-INF/liferay-friendly-url.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/frontend-data-set/frontend-data-set-taglib/src/main/resources/META-INF/frontend-data-set.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/frontend-editor/frontend-editor-taglib/src/main/resources/META-INF/liferay-editor.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/frontend-taglib/frontend-taglib/src/main/resources/META-INF/liferay-frontend.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/frontend-taglib/frontend-taglib-chart/src/main/resources/META-INF/liferay-chart.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/frontend-taglib/frontend-taglib-clay/src/main/resources/META-INF/liferay-clay.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/frontend-taglib/frontend-taglib-dynamic-section/src/main/resources/META-INF/liferay-dynamic-section.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/frontend-taglib/frontend-taglib-react/src/main/resources/META-INF/resources/react.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/frontend-taglib/frontend-taglib-soy/src/main/resources/META-INF/resources/soy.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/info/info-taglib/src/main/resources/META-INF/liferay-info.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/item-selector/item-selector-taglib/src/main/resources/META-INF/liferay-item-selector.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/journal/journal-taglib/src/main/resources/META-INF/liferay-journal.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/layout/layout-taglib/src/main/resources/META-INF/liferay-layout.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/learn/learn-taglib/src/main/resources/META-INF/liferay-learn.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/map/map-taglib/src/main/resources/META-INF/liferay-map.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/oauth2-provider/oauth2-provider-web/src/main/resources/META-INF/resources/oauth2-tree.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/portal-workflow/portal-workflow-taglib/src/main/resources/META-INF/liferay-portal-workflow.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/product-navigation/product-navigation-taglib/src/main/resources/META-INF/liferay-product-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/ratings/ratings-taglib/src/main/resources/META-INF/ratings.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/reading-time/reading-time-taglib/src/main/resources/META-INF/liferay-reading-time.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/rss/rss-taglib/src/main/resources/META-INF/liferay-rss.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/sharing/sharing-taglib/src/main/resources/META-INF/liferay-sharing.tld',
                    //'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/site/site-taglib/src/main/resources/META-INF/liferay-site.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/site-navigation/site-navigation-taglib/src/main/resources/META-INF/liferay-site-navigation.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/social/social-activities-taglib/src/main/resources/META-INF/liferay-social-activities.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/social/social-bookmarks-taglib/src/main/resources/META-INF/liferay-social-bookmarks.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/staging/staging-taglib/src/main/resources/META-INF/resources/liferay-staging.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/template/template-taglib/src/main/resources/META-INF/resources/liferay-template.tld',
                    'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/trash/trash-taglib/src/main/resources/META-INF/liferay-trash.tld'
            ])
            dest target74
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
    }
}

tasks.register('downloadCompass0122', Download) {
    src 'https://github.com/Compass/compass/archive/v0.12.2.zip'
    acceptAnyCertificate true
    overwrite true
    onlyIfNewer true
    dest new File(tempDir, 'compass-0.12.2.zip')
}

tasks.register('unzipCompass0122Stylesheets', Copy) {
    from downloadCompass0122
    from zipTree(downloadCompass0122.dest)
    include 'compass-0.12.2/frameworks/compass/stylesheets/**'
    into generatedResources + '/compass-0.12.2/stylesheets'
    eachFile { fcp ->
        fcp.path = fcp.path.replaceFirst("^compass-0.12.2/frameworks/compass/stylesheets", '')
    }
    includeEmptyDirs false
}

tasks.register('unzipCompass0122SassExtensions', Copy) {
    from downloadCompass0122
    from zipTree(downloadCompass0122.dest)
    include 'compass-0.12.2/lib/compass/sass_extensions/**'
    into generatedResources + '/compass-0.12.2/sass_extensions'
    eachFile { fcp ->
        fcp.path = fcp.path.replaceFirst("^compass-0.12.2/lib/compass/sass_extensions", '')
    }
    includeEmptyDirs false
}

tasks.register('downloadIntelliJCommunityMockJDK11') {
    doLast {
        new File(mockDir, "bin").mkdirs();

        def target = new File(mockDir, "java/mockJDK-11/jre/lib");

        target.mkdirs();

        download.run {
            src 'https://github.com/JetBrains/intellij-community/blob/master/java/mockJDK-11/jre/lib/annotations.jar?raw=true'
            dest new File(target, "annotations.jar")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }

        download.run {
            src 'https://github.com/JetBrains/intellij-community/blob/master/java/mockJDK-11/jre/lib/rt.jar?raw=true'
            dest new File(target, "rt.jar")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
    }
}

tasks.register('downloadSchemaDefinitions') {
    doLast {
        def target = new File(generatedResources, "com/liferay/schema74");

        target.mkdirs();

        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/apps/fragment/fragment-service/src/main/resources/com/liferay/fragment/internal/validator/dependencies/configuration-json-schema.json'
            dest new File(target, "configuration-json-schema.json")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
    }
}
//BND filetype definition from https://github.com/lpireyn
/*task generateBndFiletypeDefinitions {
    doLast {
        def target = new File(generatedResources, "org/bndtools/bnd");
        target.mkdirs();

        download.run {
            src 'https://raw.githubusercontent.com/lpireyn/intellij-filetypes/master/filetypes/BND%20files.xml'
            dest new File(target, "bnd.xml")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }

    }
}
*/

tasks.register('downloadPoshiGrammar') {
    doLast {
        def target = new File(generatedResources, "com/liferay/poshi");
        def syntaxes = new File(target, "syntaxes");

        target.mkdirs();

        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/test/poshi/poshi-vscode/package.json'
            dest new File(target, "package.json")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }

        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/test/poshi/poshi-vscode/language-configuration.json'
            dest new File(target, "language-configuration.json")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }

        download.run {
            src 'https://raw.githubusercontent.com/liferay/liferay-portal/master/modules/test/poshi/poshi-vscode/syntaxes/poshi.tmLanguage.json'
            dest new File(syntaxes, "poshi.tmLanguage.json")
            acceptAnyCertificate true
            overwrite true
            onlyIfNewer true
        }
    }
}

tasks.register('compilePoshi', JavaCompile) {
    sourceCompatibility = 11
    targetCompatibility = 11

    source = sourceSets.poshi.java.srcDirs

    destinationDirectory = file('build/classes/java/main')
    classpath = sourceSets.poshi.compileClasspath
}

tasks.register('downloadPoshi', Copy) {
    from configurations.poshiImplementation
    into generatedResources + '/lib'
}

group 'de.dm.intellij.liferay'
version '0.0.17'

configurations.poshiImplementation.setCanBeResolved(true)

build.dependsOn compilePoshi